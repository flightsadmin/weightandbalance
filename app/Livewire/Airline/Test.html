<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aircraft Holds - Click & Drop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        body {
            font-size: 12px;
        }

        .container-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .holding-area {
            border: 2px dashed #6c757d;
            background: #f8f9fa;
            padding: 10px;
            margin-bottom: 10px;
            width: 100%;
            text-align: center;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .holds-wrapper {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hold-container {
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 10px;
            background: #f8f9fa;
            min-width: 260px;
            flex-grow: 1;
            text-align: center;
        }

        .hold-header {
            font-weight: bold;
            padding: 5px;
        }

        .cargo-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
        }

        .cargo-slot,
        .container {
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            background: white;
            min-width: 70px;
            min-height: 70px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            transition: 0.2s;
            cursor: pointer;
        }

        .cargo-slot:hover,
        .container:hover {
            transform: scale(1.05);
            box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.2);
        }

        .occupied {
            background-color: #ffc107;
            color: #212529;
        }

        .special-load {
            background-color: #0d6efd;
            color: white;
        }

        .selected {
            border: 2px solid red !important;
        }

        .drop-target {
            background-color: #d4edda !important;
            border: 2px dashed green !important;
        }

        .drop-target:hover {
            background-color: #c3e6cb !important;
            cursor: grab;
        }
    </style>
</head>

<body>

    <div class="container mt-3" x-data="cargoManager()">
        <div class="container-wrapper">

            <!-- Holding Area for Containers -->
            <div class="holding-area">
                <template x-for="(container, index) in containers" :key="index">
                    <div class="container" x-text="container.id" x-on:click="selectCargo($el, container.id)">
                    </div>
                </template>
            </div>

            <div class="holds-wrapper">
                <!-- Forward Hold -->
                <div class="hold-container">
                    <div class="hold-header">Forward Hold (3402 kg)</div>
                    <div class="cargo-row">
                        <template x-for="slot in positions.slice(0, 8)">
                            <div class="cargo-slot" x-on:click="dropCargo($el)" x-text="slot"
                                :class="{'drop-target': selectedCargo && !slotOccupied(slot)}">
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Aft Hold -->
                <div class="hold-container">
                    <div class="hold-header">Aft Hold (2426 kg)</div>
                    <div class="cargo-row">
                        <template x-for="slot in positions.slice(8, 16)">
                            <div class="cargo-slot" x-on:click="dropCargo($el)" x-text="slot"
                                :class="{'drop-target': selectedCargo && !slotOccupied(slot)}">
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Bulk Hold -->
                <div class="hold-container">
                    <div class="hold-header">Bulk Hold (1497 kg)</div>
                    <div class="cargo-row">
                        <template x-for="slot in positions.slice(16, 20)">
                            <div class="cargo-slot" x-on:click="dropCargo($el)" x-text="slot"
                                :class="{'drop-target': selectedCargo && !slotOccupied(slot)}">
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function cargoManager() {
            return {
                selectedCargo: null,
                selectedElement: null,
                containers: Array.from({ length: 20 }, (_, i) => ({ id: `C${i + 1}` })),
                positions: ["11R", "12R", "13R", "14R", "11L", "12L", "41R", "42R", "43R", "44R", "41L", "42L", "51R", "52R", "53R", "54R", "61R", "62R", "63R", "64R"],

                selectCargo(element, cargoId) {
                    // Remove previous selection
                    if (this.selectedElement) {
                        this.selectedElement.classList.remove('selected');
                    }
                    document.querySelectorAll('.cargo-slot').forEach(slot => {
                        slot.classList.remove('drop-target');
                    });

                    this.selectedCargo = cargoId;
                    this.selectedElement = element;
                    element.classList.add('selected');

                    // Highlight valid drop zones
                    document.querySelectorAll('.cargo-slot:not(.occupied)').forEach(slot => {
                        slot.classList.add('drop-target');
                    });
                },

                dropCargo(targetElement) {
                    // Check if it's being dropped in the holding area
                    if (targetElement.classList.contains('container')) {
                        // Move container back to holding area
                        this.moveToHoldingArea(targetElement);
                    } else if (this.selectedCargo && !targetElement.classList.contains('occupied')) {
                        // Drop in hold slot
                        targetElement.innerHTML = `${this.selectedCargo} <br> <i class="bi bi-box-seam"></i>`;
                        targetElement.classList.add('occupied');
                        this.selectedElement.remove(); // Remove from holding area
                        this.selectedCargo = null;
                        this.selectedElement = null;
                    }
                },

                moveToHoldingArea(targetElement) {
                    // Move the container back to the holding area
                    const containerElement = document.querySelector(`.container[data-id="${this.selectedCargo}"]`);
                    this.selectedElement = null;
                    this.selectedCargo = null;

                    // Remove the selected element from the target slot
                    targetElement.innerHTML = '';

                    // Add the container back to the holding area (optional: create new elements or reuse existing)
                    const holdingArea = document.querySelector('.holding-area');
                    holdingArea.appendChild(containerElement);
                    containerElement.classList.remove('selected');
                },

                slotOccupied(slot) {
                    return document.querySelector(`.cargo-slot[x-text="${slot}"]`).classList.contains('occupied');
                }
            };
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>